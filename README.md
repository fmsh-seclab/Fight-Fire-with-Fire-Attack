# Fight-Fire-with-Fire-Attack
This repository contains the artifact for our paper "**Classical Attacks, Modern Targets:Side-Channel Compromises Secure Boot Key in NVIDIA Jetson Edge AI**" published at NDSS 2026.

Our investigation uncovered **Fight-Fire-with-Fire Attack** (CVE-2025-xxxxx), a novel and unpatchable vulnerability in the Nvidia Jetson Xavier NX SoC, which enabling `Secure Boot key (SBK)` recovery through GPU-accelerated 32-bit correlation power analysis (CPA) within 10 hours.
## Structure and File Descriptions
This repository is structured as follows:
- **`EM_Trace/`**: Contains the EM Traces set captured during the decryption of the MB1 firmware with SBK.

- **`rcm_message/`**: Contains the encrypted MB1 files generated by Jetson Linux BSP tool kit.  

- **`jetson_32bit_cpa.cu`**: Implements a GPU-accelerated 32bit CPA algorithm for key recovery.
  
- **`Result.txt`**: Records CPA result, including: top 4 candidate key and correlation coefficients and the AES-128 master key.
  
- **`roundkey.bin`**: Stores round keys generated by the CPA algorithm in `jetson_32bit_cpa.cu`.
  
- **`POC.sh`**: Automates the POC workflow:
  - 1. Compiles `jetson_32bit_cpa.cu` into an executable `jetson_32bit_cpa`.
  - 2. Runs the CUDA program `jetson_32bit_cpa` and output **SBK** value to `Result.txt`.
  - 3. Runs the Python script `decrypt.py` to decrypt the 8 rcm message with **SBK** and store to `decrypted_rcm_message/`.
  
- **`decrypted_rcm_message/`**: Contains the decrypted rcm message.

- **`image/`**: Contains the image files for README introduction.

## Measurement Setup Introduction
The following components and configuration were used:
1. **Target of Evaluation (TOE)**: NVIDIA Jetson Xavier NX SOM, connected to a modified carrier board.

2. **Power Supplies**: Two Agilent E3631A DC power supplies provided clean 5V (VDD_IN) and 0.85V (VDD_CORE) inputs.

3. **Electromagnetic Probe**: A Langer EMV RF-R 3-2 probe was used to capture EM signals.

4. **RF Amplifier**: A Mini-Circuits ZFL-1000LN+ amplifier was used to amplify weak EM signals.

5. **Oscilloscope**: A Lecroy 625Zi oscilloscope recorded the amplified signals.

6. **Embedded Development Board**: A Jetson-based kit controlled the TOE's SYS_RESET pin and generated synchronized trigger signals for the oscilloscope.

<div style="text-align:center">
<img src="./image/setup.svg" alt="probe" style="zoom:10%; display: block; margin: 0 auto;" /></div>

## EM Signal Acquisition
The `Langer EMV RF-R 3-2` probe positioned at the location indicated in Figure captured distinctive signals. These signals were closely correlated with the TOE's signature verification and firmware decryption operations.

  |        Phase         | Sampling Rate | Bandwidth | Resolution | Duration | Vertical Resolution |
  | :------------------: | :-----------: | :-------: | :--------: | :------: | :-----------------: |
  | Preliminary Analysis |   250 MS/s    |  2.5 GHz  |   8-bit    | 18.5 ms  |    5 mV/division    |
  |   Real-World Attack   |    5 GS/s     |  2.5 GHz  |   8-bit    |  0.5 ms  |    5 mV/division    |

<div style="text-align:center">
<img src="./image/probe.JPG" alt="probe" style="zoom:10%; display: block; margin: 0 auto;" />
</div>

## RCM Message  

## Trace File

## Proof of Concepts

## Key Recovery Result
